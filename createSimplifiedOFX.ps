[CmdletBinding(SupportsShouldProcess = $true)]
param(
    [Parameter(Mandatory = $true)]
    [Alias('Entries')]
    [string[]]$Entry,

    [Parameter()]
    [Alias('OutFile')]
    [string]$OutputPath = 'C:\output\import.ofx',

    [switch]$Force
)

Set-StrictMode -Version Latest
$ErrorActionPreference = 'Stop'

$targetScript = Join-Path -Path $PSScriptRoot -ChildPath 'CreateSimplifiedOFX.ps1'
if (-not (Test-Path -LiteralPath $targetScript -PathType Leaf)) {
    throw "Script not found: $targetScript"
}

$invokeParams = @{
    Entry      = $Entry
    OutputPath = $OutputPath
}

if ($Force.IsPresent) { $invokeParams['Force'] = $true }
if ($WhatIfPreference) { $invokeParams['WhatIf'] = $true }
if ($VerbosePreference -ne 'SilentlyContinue') { $invokeParams['Verbose'] = $true }

& $targetScript @invokeParams
